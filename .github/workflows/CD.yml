name : 'Deployment'

on :
  pull_request :
    branches : [main]
  push :
    branches : [main]

jobs :
  Build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - name: Setup node
        uses: actions/setup-node@v3
        with:
          node-version: 16
      - run: yarn install
      - run: yarn build

  Deploy:
    runs-on: ubuntu-latest
    needs: Build
    name: Deploy to render

    steps:
      - name: TRigger Deployment
        uses: johnbeynon/render-deploy-action
        with: 
          api-key: ${{secrets.RENDER_API_KEY}}